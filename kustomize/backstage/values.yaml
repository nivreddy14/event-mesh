postgresql:
  enabled: true

ingress:
  enabled: true
  host: backstage.127.0.0.1.nip.io
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
  tls:
    enabled: true
    secretName: backstage-tls

backstage:
  extraEnvVars:
    - name: BACKSTAGE_AUTH_LEGACY_GUEST
      value: "true"
    - name: BACKEND_SECRET
      value: dev-backstage-key
  extraEnvVarsSecrets:
    - backstage-github-auth
  appConfig:
    app:
      title: Backstage
      baseUrl: https://backstage.127.0.0.1.nip.io
    backend:
      baseUrl: https://backstage.127.0.0.1.nip.io
      cors:
        origin: https://backstage.127.0.0.1.nip.io
        credentials: true
        methods: [GET, POST, PUT, DELETE, PATCH]
        allowedHeaders: [Authorization, Content-Type, Cookie]
      auth:
        keys:
          - secret: ${BACKEND_SECRET}
    auth:
      environment: production
      providers:
        github:
          production:
            clientId: ${GITHUB_CLIENT_ID}
            clientSecret: ${GITHUB_CLIENT_SECRET}
            callbackUrl: https://backstage.127.0.0.1.nip.io/api/auth/github/handler/frame
    signIn:
      resolvers:
        - resolver: github
    techdocs:
      builder: local
      generator:
        runIn: docker
      publisher:
        type: local
    kubernetes:
      serviceLocatorMethod:
        type: multiTenant
      clusterLocatorMethods:
        - type: config
          clusters:
            - name: in-cluster
              url: https://kubernetes.default.svc
              authProvider: serviceAccount
              skipTLSVerify: true
